main program <CARIE.py>
Required Parameters:
-i/--input:
	-i/--input: s1.bam/s1.sam[,s2.bam/s2.sam]. Mapping results for all of samples in bam/sam format. Different samples sepreated in a comma seperated list
--GTF:
	The gtf file

Optional Parameters:
-o/--output:
	-o/--output: The output directory. The default is current directory
--lib
	The library build method with choices of first/second/unstrand. The default is unstrand.
--read
	The sequencing strategy of producing reads with choices of P/S. The default is P
--length
	The reads length in nucleotide. The default length is 100
--anchor
	The anchor length used in counting the junction reads. The program will only counts junctions spanned by reads with at least this many bases on each side of the junction. The default is 8
--type
	The types of RI level calculation used. The choices are Junction/JunctionIntron/5Simple/3Simple/5Complex/3Complex/all. If type is all, all of the six types of calcuation will be carried out,but the rMATS will not performed. The default is Junction
--comparison
	A file providing the samples pairs need to be calculating the differential RI level. Format should be column 1(name of comparions), column 2 (sample 1 order in the input file seperated by comma), column 3 (sample 2 order in the input file seperated by comma). If absent, rMATs step will be skipped
--analysis
	Type of rMATS analysis to perform. analysisType is either 'P' or 'U'. 'P' is for paired analysis and 'U' is for unpaired analysis. Default is 'U' 

Examples:
python CARIE.py --GTF ./test/Mus_musculus.Ensembl.GRCm38.78.gtf -i ./test/total_0.bam,./test/cytosol_0.bam,./test/nucleus_0.bam --anchor 6 --length 50 --lib unstrand --read S --type introns --comparison ./test/comparison -o ./test --analysis U


Output list:
result:
All of final result files are in result folder.
counts_all_$type.txt store the inclusion and skipping counts for all of the samples
    column 1: Intron Id representing the chromosome position, start and end.
    column 2: Gene id
    column 3: Strand
    column 4: Chromosome name
    column 5: Start coordinate
    column 6: End coordinate
    column 7: Whether this intron was annotated in the gtf file as retained intron event.
    column 8: Whether this intron was overlapped with exon, or the 5' splice site was overlapped with exon or the 3' site was overlapped with exon or whether this intron is a simple intron
    column 9: Inclusion counts for all of the samples seperated by comma
    column 10: Skipping counts for all of the samples seperated by comma
    column 11: Inclusion length
    column 12: Skipping length
    column 13: Intron inclusion level for all of the samples seperated by comma

rMATs_Result_$comparison_$type.txt store the differential RI level calculated by rMATS
    column 1: Intron Id representing the chromosome position, start and end.
    column 2: Gene id
    column 3: Strand
    column 4: Chromosome name
    column 5: Start coordinate
    column 6: End coordinate
    column 7: Whether this intron was annotated in the gtf file as retained intron event.
    column 8: Whether this intron was overlapped with exon, or the 5' splice site was overlapped with exon or the 3' site was overlapped with exon or whether this intron is a simple intron
    column 9: Inclusion counts for all replicates  of sample 1 seperated by comma
    column 10: Skipping counts for all replicates  of sample 1 seperated by comma
    column 11: Inclusion counts for all replicates  of sample 2 seperated by comma
    column 12: Skipping counts for all replicates  of sample 2 seperated by comma
    column 13: Inclusion length
    column 14: Skipping length
    column 15: p-value for differential RI level of the two samples
    column 16: FDR for differential RI level of the two samples
    column 17: RI level for sample1, replicates seperated by comma
    column 18: RI level for sample1, replicates seperated by comma
    column 19: The difference of RI level between sample1 and sample2, which is the result of average intron incluion level of sampel1 minus the average intron incluion level of sampel2.

test:
A folder contains test files to run the program
three bam files and a comparison files to run the program. it can be run as
python CARIE.py --gtf Mus_musculus.Ensembl.GRCm38.78.gtf -i ./test/total_0.bam,./test/cytosol_0.bam,./test/nucleus_0.bam --anchor 6 --length 50 --lib unstrand --read S --type introns --comparison ./test/comparison -o .


log.CARIE: Log file for running CARIE pipeline

 

gtf_files:
A folder contains different types of gtf files to run the program. Use mouse genome as examples.
Mus_musculus.Ensembl.GRCm38.78.gtf: the ensemble gtf files
Exon_Mus_musculus.Ensembl.GRCm38.78.gtf: the gtf files contains exons only
Intron_Mus_musculus.Ensembl.GRCm38.78.gtf: the gtf files contains intron only
Intron_Annotated_Mus_musculus.Ensembl.GRCm38.78.gtf: gtf files contains the attributes whether the intron was annotated as retended introns in the original gtf files
Intron_clean_Mus_musculus.Ensembl.GRCm38.78.gtf: gtf files contains the attributes whether the intron/5'Junction/3'Junction was overlapped with Exon in the original gtf files

counts:
A folder contains all of the count files
n = number of samples
count_all.txt: a file contains the counts for all of the introns
    column 1:Intron Id representing the chromosome position, start and end.
    column 2:Gene id
    column 3:Strand
    column 4:Chromosome name
    column 5:Start coordinate
    column 6:End coordinate    column 1: Intron Id representing the chromosome position, start and end.
    column 7: Inclusion counts at 5' splice sites for sample 1
    column 8: Skipping counts at 5' splice sites for sample 1
    column 9: Inclusion counts at 3' splice sites for sample 1
    column 10: Skipping counts at 3' splice sites for sample 1
    column 11: Skipping counts of the intron for sample 1
    column 12: counts lying in the intron for sample 1
    column 13-6*(n+1): more counts for samples 2-n

rMATs_$comparison_$type.txt
    The input file for running rMATs.

rMATs_$comparison_$type folder
    The folder contains the result of rMATs output.



###############################################################################################################################################

main program <rMATs.py>

Required Parameters:
-i/--input:
	The count files generated by CARIE program
--comparion
	A file providing the samples pairs need to be calculating the differential RI level. Format should be column 1(name of comparions), column 2 (sample 1 order in the input file seperated by comma), column 3 (sample 2 order in the input file seperated by comma). If absent, rMATs step will be skipped

Optional Parameters:
-o/--output:
	The output directory. The default is current directory
--analysis:
	Type of rMATS analysis to perform. analysisType is either 'P' or 'U'. 'P' is for paired analysis and 'U' is for unpaired analysis. Default is 'U' 
--p
	The number of threads used to run rMATS. The default is 1
--FDR
	The maximum FDR  used to output the significant differential RI events. The default is 0.05
--Diff
	The minimum difference of RI level used to output the significant differential RI events. The default is 0.05

Examples:
python rMATsCI.py --input ./test/result/counts_all_Junction.txt --comparison ./test/comparison --output ./test --p 1 --FDR 0.05 --Diff 0.05 --analysis U

Output list:

rMATs_Result_$comparison.txt store the differential RI level calculated by rMATS
    column 1: Intron Id representing the chromosome position, start and end.
    column 2: Gene id
    column 3: Strand
    column 4: Chromosome name
    column 5: Start coordinate
    column 6: End coordinate
    column 7: Whether this intron was annotated in the gtf file as retained intron event.
    column 8: Whether this intron was overlapped with exon, or the 5' splice site was overlapped with exon or the 3' site was overlapped with exon or whether this intron is a simple intron
    column 9: Inclusion counts for all replicates  of sample 1 seperated by comma
    column 10: Skipping counts for all replicates  of sample 1 seperated by comma
    column 11: Inclusion counts for all replicates  of sample 2 seperated by comma
    column 12: Skipping counts for all replicates  of sample 2 seperated by comma
    column 13: Inclusion length
    column 14: Skipping length
    column 15: p-value for differential RI level of the two samples
    column 16: FDR for differential RI level of the two samples
    column 17: RI level for sample1, replicates seperated by comma
    column 18: RI level for sample1, replicates seperated by comma
    column 19: The difference of RI level between sample1 and sample2, which is the result of average intron incluion level of sampel1 minus the average intron incluion level of sampel2

Decrease_rMATs_Result_$comparison.txt store the significantly decreased RI level calculated by rMATS and have the same format as rMATs_Result_$comparison.txt

Increase_rMATs_Result_$comparison.txt store the significantly increased RI level calculated by rMATS and have the same format as rMATs_Result_$comparison.txt

rMATs_$comparison.txt  is the input file for running rMATs.

rMATs_$comparison folder
    A folder contains the result of rMATs output.

